# Domain 4.5 – Modify Enterprise Capabilities to Enhance Security Based on the Scenario

---

## Firewall

> **How it works:** Inspects traffic and enforces rules to allow/block based on protocol, port, or application.  
> **Best use:** First line of defense at network boundaries.

### Types
- **Traditional firewall**  
  - Decisions based on **port numbers (TCP/UDP)**.  

- **Next-Generation Firewall (NGFW)**  
  - Inspects at **application layer (Layer 7)**.  
  - AKA: Application layer gateway / Stateful multilayer inspection / Deep packet inspection.  
  - Can categorize/analyze every packet.  

### Ports & Protocols
- **Traditional rules**: forwarding based on protocol + port.  
- Examples:  
  - Web server → TCP/80, TCP/443  
  - SSH → TCP/22  
  - Microsoft RDP → TCP/3389  
  - DNS query → UDP/53  
  - NTP → UDP/123  

### Firewall Rules
- Evaluated **top to bottom**.  
- Types: specific vs general.  
- Always ends with **implicit deny**.  
- **ACLs (Access Control Lists)**: allow/deny based on source IP, dest IP, port, app, time of day.  

### Screened Subnet (DMZ)
- Adds extra security layer between internal network & internet.  
- Public resources accessible, private resources hidden.  

**Cheatsheet – Firewall Types**

| **Type** | **Decision Basis** | **Notes** |
|----------|---------------------|-----------|
| Traditional | Port & protocol | Basic, L3/L4 |
| NGFW | Application layer (L7) | DPI, more advanced |
| Screened Subnet | Isolated zone | Public access only |

---

## IDS / IPS

- **IPS**: actively blocks malicious traffic.  
- **IDS**: detects & alerts only.  
- Methods:  
  - **Signature-based** → looks for exact match.  
  - **Anomaly-based** → builds baseline of normal traffic, flags unusual patterns.  
- Usually integrated into NGFW.  

---

## Web Filtering

- **Content filtering** → control inbound/outbound data, block inappropriate/malicious content.  
- **URL scanning** → allow/block lists, managed by categories (malware, hacking, recreation, etc).  
- **Agent-based filters** → client-side software.  
- **Proxies** → sit between user & internet (forward proxy for caching, access control, URL filtering).  
- **Block rules** → specific URLs or categories.  
- **Reputation systems** → block sites with poor reputations.  
- **DNS filtering** → block harmful sites at DNS lookup (no IP returned).  

---

## Operating System Security

### Active Directory (AD)
- Central database of network resources.  
- Used for authentication (user logins) & access control.  
- Help desk: reset pw, add/remove accounts.  

### Group Policy
- Manage users & computers centrally.  
- Examples: login scripts, network config, security parameters.  

### SELinux (Security-Enhanced Linux)
- Adds **MAC (Mandatory Access Control)** to Linux kernel (Linux normally uses DAC).  
- Limits app access (least privilege).  
- Open source.  

---

## Implementation of Secure Protocols

### Unencrypted Data (insecure protocols)
- **Telnet, FTP, SMTP, IMAP** → no encryption.  
- Verify via **packet capture**.  

### Protocol Selection
- Always use **secure equivalents** with encryption.  

| **Application** | **Insecure Protocol** | **Secure Protocol** |
|-----------------|------------------------|----------------------|
| Remote console  | Telnet                 | SSH |
| Web browsing    | HTTP                   | HTTPS |
| Email access    | IMAP                   | IMAPS |
| File transfer   | FTP                    | SFTP |

### Port Selection
- Example: HTTP 80 vs HTTPS 443.  
- Port number ≠ guarantee of encryption. Must confirm via config/packet capture.  

### Transport Method
- **802.11 wireless open AP** → no encryption.  
- **WPA3** → all data encrypted.  
- **VPN tunnels** → create encrypted paths.  

---

## Email Security

### Mail Gateway
- Acts like a firewall for mail traffic.  

### SPF (Sender Policy Framework)
- Defines authorized mail servers in **DNS TXT record**.  

### DKIM (DomainKeys Identified Mail)
- Mail server digitally signs outgoing mail with public key (DNS TXT record).  

### DMARC
- Extension of SPF + DKIM.  
- Defines what to do with invalid emails.  
- Provides compliance reports to admins.  

---

## Monitoring Data

### File Integrity Monitoring (FIM)
- Detects unauthorized file changes.  
- Tools:  
  - Windows → **SFC** (System File Checker).  
  - Linux → **Tripwire**.  
  - Host-based IPS options.  

### DLP (Data Loss Prevention)
- Prevent sensitive data leakage.  
- **Types**:  
  - Endpoint/PC → data in use.  
  - Network → data in motion.  
  - Server/File → data at rest.  

- **USB Blocking** → stop copying to removable media.  
- **Cloud DLP** → block defined data strings, manage URLs, block malware.  
- **Email DLP** → inbound (block malicious content) + outbound (block sensitive leaks).  

---

## Network Access Control (NAC)

### Edge vs Access
- **Edge control** → firewalls, static rules.  
- **Access control** → dynamic, per-device/user.  

### Posture Assessment
- Checks devices before network connection.  
- Look for: malware, missing AV, outdated patches.  

**Agent Types**
- **Persistent agent** → installed, updated periodically.  
- **Dissolvable agent** → temporary, runs only during check.  
- **Agentless NAC** → integrated with AD, checks at login/logout only.  

**Failing Assessment**
- Device placed in **quarantine network** until fixed.  

---

## Endpoint Detection & Response (EDR / XDR)

### EDR
- **Lightweight agent** on endpoint.  
- Detect via signatures, behavior, ML, process monitoring.  
- Investigate → root cause analysis.  
- Respond → isolate system, quarantine, rollback.  

### XDR (Extended Detection & Response)
- Next-gen EDR, includes **network & cloud data correlation**.  
- Improves detection & reduces false positives.  
- Centralized investigation across endpoints + network + cloud.  

---

## User Behavior Analytics (UBA)
- Monitors **users, hosts, network, data**.  
- Looks for **unusual/abnormal activity**.  
- Often integrated into XDR for real-time anomaly detection.  

---

# Exam Triggers Quick Recall – Modify Capabilities (4.5)

- **Traditional firewall** = port/protocol.  
- **NGFW** = application-level, DPI.  
- **ACL rules** = top-to-bottom, implicit deny.  
- **Screened subnet (DMZ)** = public access zone.  
- **IDS vs IPS** = detect vs block.  
- **Signature vs anomaly-based** detection.  
- **URL filter / DNS filter** = web restrictions.  
- **Active Directory** = centralized authentication.  
- **Group Policy** = enforce configs/security params.  
- **SELinux** = MAC in Linux.  
- **Insecure vs Secure protocols** = Telnet→SSH, HTTP→HTTPS, IMAP→IMAPS, FTP→SFTP.  
- **SPF/DKIM/DMARC** = email security trio.  
- **FIM** = file monitoring (SFC, Tripwire).  
- **DLP** = data in use, motion, rest; includes USB, cloud, email.  
- **NAC posture check** = persistent/dissolvable/agentless → quarantine failures.  
- **EDR** = endpoint only; **XDR** = endpoint + network + cloud.  
- **UBA** = anomaly detection via user behavior.  












#### Frequently Asked Ports (Exam Focus)

| **Service**         | **Port (TCP/UDP)** | **Notes** |
|----------------------|--------------------|-----------|
| **FTP (control/data)** | 21 (control), 20 (data) | Insecure → use SFTP/FTPS |
| **SSH / SFTP / SCP** | 22 | Secure remote login/file transfer |
| **Telnet**           | 23 | Insecure remote login |
| **SMTP**             | 25 | Mail transfer (unencrypted) |
| **DNS**              | 53 TCP/UDP | TCP for zone transfers, UDP for queries |
| **DHCP**             | 67 (server), 68 (client) | Auto IP assignment |
| **TFTP**             | 69 | Trivial FTP, insecure |
| **HTTP / HTTPS**     | 80 / 443 | Web traffic |
| **POP3 / POP3S**     | 110 / 995 | Email retrieval |
| **IMAP / IMAPS**     | 143 / 993 | Email retrieval with folders |
| **SNMP**             | 161/162 UDP | 161 = polling, 162 = traps |
| **LDAP / LDAPS**     | 389 / 636 | Directory services |
| **SMB / CIFS**       | 445 | File sharing (Windows) |
| **Syslog**           | 514 UDP | Log forwarding |
| **RDP**              | 3389 | Remote desktop |
| **NTP**              | 123 UDP | Time sync |
| **Kerberos**         | 88 | Authentication protocol |


