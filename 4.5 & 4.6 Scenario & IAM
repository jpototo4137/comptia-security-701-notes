# Domain 4.5 – Modify Enterprise Capabilities to Enhance Security Based on the Scenario

---

## Firewall

**How it works**  
- Controls traffic based on rules (ports, protocols, apps).  
- Blocks or permits traffic between trusted/untrusted networks.  

**Best use**  
- Enforce network access policies and segment resources.  

### Types
- **Traditional Firewall** → filters by **port numbers** (TCP/UDP).  
- **Next-Gen Firewall (NGFW)** → filters by **application layer (Layer 7)**.  
  - AKA: Application Layer Gateway, Stateful Multilayer Inspection, Deep Packet Inspection.  
  - Analyzes/categorizes **packets by content**, not just port.  

### Ports & Protocols
- Forwarding decisions: protocol + port number.  
- Examples:  
  - Web server → TCP/80, TCP/443  
  - SSH → TCP/22  
  - RDP → TCP/3389  
  - DNS → UDP/53  
  - NTP → UDP/123  

#### Frequently Asked Ports (Exam Focus)

| **Service**         | **Port (TCP/UDP)** | **Notes** |
|----------------------|--------------------|-----------|
| **FTP (control/data)** | 21 (control), 20 (data) | Insecure → use SFTP/FTPS |
| **SSH / SFTP / SCP** | 22 | Secure remote login/file transfer |
| **Telnet**           | 23 | Insecure remote login |
| **SMTP**             | 25 | Mail transfer (unencrypted) |
| **DNS**              | 53 TCP/UDP | TCP for zone transfers, UDP for queries |
| **DHCP**             | 67 (server), 68 (client) | Auto IP assignment |
| **TFTP**             | 69 | Trivial FTP, insecure |
| **HTTP / HTTPS**     | 80 / 443 | Web traffic |
| **POP3 / POP3S**     | 110 / 995 | Email retrieval |
| **IMAP / IMAPS**     | 143 / 993 | Email retrieval with folders |
| **SNMP**             | 161/162 UDP | 161 = polling, 162 = traps |
| **LDAP / LDAPS**     | 389 / 636 | Directory services |
| **SMB / CIFS**       | 445 | File sharing (Windows) |
| **Syslog**           | 514 UDP | Log forwarding |
| **RDP**              | 3389 | Remote desktop |
| **NTP**              | 123 UDP | Time sync |
| **Kerberos**         | 88 | Authentication protocol |

### Firewall Rules
- Processed **top to bottom**.  
- General vs specific rules.  
- **Implicit deny** → block anything not explicitly allowed.  
- **ACLs (Access Control Lists)** → filter traffic by IP, port, time, application, etc.  

### Screened Subnet
- Adds a **buffer zone** between internet and private LAN.  
- Public-facing resources in subnet; private data inaccessible.  

**Cheatsheet – Firewalls**

| **Type** | **Filter Basis** | **Example/Notes** |
|----------|------------------|-------------------|
| Traditional | Ports & protocols | TCP/UDP filtering |
| NGFW | Application layer | DPI, stateful inspection |
| Screened Subnet | Public vs private | Buffer zone |
